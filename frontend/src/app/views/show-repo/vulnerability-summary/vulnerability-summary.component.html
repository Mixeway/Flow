<div class="vulnerability-dashboard">
    <div class="dashboard-header mb-3">
        <h2 class="dashboard-title">Vulnerability Summary</h2>
        <div class="total-vulnerabilities">
            <span class="total-count">{{ getTotalCount() }}</span>
            <span class="total-label">Total Findings</span>
            <div class="total-breakdown" *ngIf="counts?.urgent > 0 || counts?.notable > 0">
                Including
                <span *ngIf="counts?.urgent > 0" class="breakdown-badge urgent">
                    {{ counts.urgent }} Urgent
                </span>
                <span *ngIf="counts?.notable > 0" class="breakdown-badge notable">
                    {{ counts.notable }} Notable
                </span>
            </div>
        </div>
    </div>

    <c-row class="vulnerability-cards">
        <c-col [lg]="4" [md]="6" [sm]="12" class="mb-3">
            <div class="vuln-card critical-card">
                <div class="vuln-card-header">
                    <div class="severity-badge critical">Critical</div>
                    <div class="vuln-count">{{ counts?.critical || 0 }}</div>
                </div>

                <div class="vuln-card-body">
                    <div class="vuln-icon">
                        <svg [cIcon]="icons.cilBug" width="24"></svg>
                    </div>

                    <div class="vuln-info">
                        <div class="vuln-percent">
                            {{ getPercentage(counts?.critical) }}%
                        </div>
                        <div class="vuln-bar-container">
                            <div class="vuln-bar critical-bar" [style.width.%]="getPercentage(counts?.critical)"></div>
                        </div>
                    </div>
                </div>

                <div class="vuln-card-footer">
                    <div class="risk-level">Highest Risk Level</div>
                    <div class="action-required">Immediate Action Required</div>
                </div>
            </div>
        </c-col>

        <c-col [lg]="4" [md]="6" [sm]="12" class="mb-3">
            <div class="vuln-card high-card">
                <div class="vuln-card-header">
                    <div class="severity-badge high">High</div>
                    <div class="vuln-count">{{ counts?.high || 0 }}</div>
                </div>

                <div class="vuln-card-body">
                    <div class="vuln-icon">
                        <svg [cIcon]="icons.cilCenterFocus" width="24"></svg>
                    </div>

                    <div class="vuln-info">
                        <div class="vuln-percent">
                            {{ getPercentage(counts?.high) }}%
                        </div>
                        <div class="vuln-bar-container">
                            <div class="vuln-bar high-bar" [style.width.%]="getPercentage(counts?.high)"></div>
                        </div>
                    </div>
                </div>

                <div class="vuln-card-footer">
                    <div class="risk-level">Significant Risk Level</div>
                    <div class="action-required">Prioritize Remediation</div>
                </div>
            </div>
        </c-col>

        <c-col [lg]="4" [md]="6" [sm]="12" class="mb-3">
            <div class="vuln-card other-card">
                <div class="vuln-card-header">
                    <div class="severity-badge other">Other</div>
                    <div class="vuln-count">{{ counts?.rest || 0 }}</div>
                </div>

                <div class="vuln-card-body">
                    <div class="vuln-icon">
                        <svg [cIcon]="icons.cilCommentSquare" width="24"></svg>
                    </div>

                    <div class="vuln-info">
                        <div class="vuln-percent">
                            {{ getPercentage(counts?.rest) }}%
                        </div>
                        <div class="vuln-bar-container">
                            <div class="vuln-bar other-bar" [style.width.%]="getPercentage(counts?.rest)"></div>
                        </div>
                    </div>
                </div>

                <div class="vuln-card-footer">
                    <div class="risk-level">Lower Risk Level</div>
                    <div class="action-required">Address When Possible</div>
                </div>
            </div>
        </c-col>
    </c-row>

    <c-row *ngIf="counts?.autoFixable || counts?.fixed" class="additional-metrics mt-2">
        <c-col [lg]="6" [md]="6" [sm]="12" class="mb-3" *ngIf="counts?.autoFixable">
            <div class="metric-card autofix-card">
                <div class="metric-icon">
                    <svg [cIcon]="icons.cilWrench" width="20"></svg>
                </div>
                <div class="metric-content">
                    <div class="metric-title">Auto-Fixable</div>
                    <div class="metric-value">{{ counts?.autoFixable || 0 }}</div>
                    <div class="metric-description">Vulnerabilities that can be automatically remediated</div>
                </div>
            </div>
        </c-col>

        <c-col [lg]="6" [md]="6" [sm]="12" class="mb-3" *ngIf="counts?.fixed">
            <div class="metric-card fixed-card">
                <div class="metric-icon">
                    <svg [cIcon]="icons.cilCheckAlt" width="20"></svg>
                </div>
                <div class="metric-content">
                    <div class="metric-title">Recently Fixed</div>
                    <div class="metric-value">{{ counts?.fixed || 0 }}</div>
                    <div class="metric-description">Vulnerabilities remediated in the last 30 days</div>
                </div>
            </div>
        </c-col>
    </c-row>
</div>